<%- include('layout/header') %>

<div class="container">
    <div class="row">
        <div class="col-lg-6 mx-auto mt-4">
             <div class="card shadow">
                   <div class="card-header bg-success">
                       <h3 class="text-light">Edit User(<%= user.name %>)</h3>
                   </div>
                   <div class="card-body p-4">
                         <form action="/update/<%= user._id %>" method="post" id="add-form" enctype="multipart/form-data">
                              <div class="mb-3">
                                <label for="name">Name</label>
                                <input type="text" name="name" value="<%= user.name %>" class="form-control form-control-lg" placeholder="Enter name" required/>
                              </div>
                              <div class="mb-3">
                                <label for="email">Email</label>
                                <input type="email" name="email" value="<%= user.email %>" class="form-control form-control-lg" placeholder="Enter email" required/>
                              </div>
                              <div class="mb-3">
                                <label for="phone">Phone</label>
                                <input type="tel" name="phone" value="<%= user.phone %>" class="form-control form-control-lg" placeholder="Enter phone" required/>
                              </div>
                              <!-- <div class="mb-3">
                                <label for="image" class="form-label">Select Image</label>
                                <input type="file" name="image" class="form-control form-control-lg" />
                                <img src="/<%= user.image %>" width="100" class="img-thumbnail mt-1">
                              </div>
                              <input type="hidden" name="old_image" value="<%= user.image %>"/> -->
                              <div class="mb-3">
                                <label for="image" class="form-label">Select Image</label>
                                <input type="file" name="image" class="form-control form-control-lg" id="imageInput" />
                                <div class="mt-2">
                                    <!-- Old Image Preview -->
                                    <label for="oldImage">Old Image</label>
                                    <img src="/<%= user.image %>" width="100" class="img-thumbnail mt-1" id="oldImagePreview">
                                </div>
                                <div class="mt-2">
                                    <!-- New Image Preview -->
                                    <label for="newImage">New Image Preview</label>
                                    <img src="#" alt="New Image Preview" width="100" class="img-thumbnail mt-1" id="newImagePreview" style="display: none;">
                                </div>
                            </div>
                            <input type="hidden" name="old_image" value="<%= user.image %>"/>
                            
                              <div class="mb-3 d-grid">
                                <input type="submit" name="submit" value="update User" class="btn btn-success btn-lg"/>
                              </div>
                         </form>
                   </div>
             </div>
        </div>
    </div>
</div>
<script>
  document.addEventListener("DOMContentLoaded", function() {
      // Get references to the file input and image preview elements
      var imageInput = document.getElementById("imageInput");
      var oldImagePreview = document.getElementById("oldImagePreview");
      var newImagePreview = document.getElementById("newImagePreview");
  
      // Add event listener to the file input
      imageInput.addEventListener("change", function() {
          // Check if a file is selected
          if (imageInput.files && imageInput.files[0]) {
              var reader = new FileReader();
  
              // Set the new image source to the selected file's data URL
              reader.onload = function(e) {
                  newImagePreview.src = e.target.result;
              };
  
              // Read the selected file as a data URL
              reader.readAsDataURL(imageInput.files[0]);
  
              // Show both the new and old image previews
              newImagePreview.style.display = "block";
              oldImagePreview.style.display = "block";
          } else {
              // Hide the new image preview and show the old one if no file is selected
              newImagePreview.style.display = "none";
              oldImagePreview.style.display = "block";
          }
      });
  });
  </script>
  
  
<%- include('layout/footer') %>
    